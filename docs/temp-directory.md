<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /docs/mdsource/temp-directory.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

## TempDirectory

A temporary directory helper for tests that automatically cleans up directories.


### Features

- Creates unique temporary directories in `%TEMP%\VerifyTempDirectory\{Path.GetRandomFileName()}`
- Automatic cleanup on dispose
- Implicit conversion to `string` and `DirectoryInfo`
- Thread-safe directory creation
- Removes orphaned directories older than 24 hours


#### Orphaned directories

Orphaned directories can occur in the following scenario

 * A breakpoint is set in a test that uses TempDirectory
 * Debugger is launched and that breakpoint is hit
 * Debugger is force stopped, resulting in the `TempDirectory.Dispose()` not being executed


### Usage

<!-- snippet: TempDirectory -->
<a id='snippet-TempDirectory'></a>
```cs
[Fact]
public void Usage()
{
    using var temp = new TempDirectory();

    // write a file to the temp directory
    File.WriteAllText(Path.Combine(temp, "test.txt"), "content");

    // Directory and files automatically deleted here
}
```
<sup><a href='/src/Verify.Tests/TempDirectoryTests.cs#L31-L44' title='Snippet source file'>snippet source</a> | <a href='#snippet-TempDirectory' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Path Property

Contains the full path to the temporary directory.

<!-- snippet: TempDirectoryPathProperty -->
<a id='snippet-TempDirectoryPathProperty'></a>
```cs
[Fact]
public void PathProperty()
{
    using var temp = new TempDirectory();
    var path = temp.Path;
    Assert.True(Directory.Exists(path));
    Assert.True(Path.IsPathRooted(path));
}
```
<sup><a href='/src/Verify.Tests/TempDirectoryTests.cs#L226-L237' title='Snippet source file'>snippet source</a> | <a href='#snippet-TempDirectoryPathProperty' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Implicit Conversion

Implicit Conversion is helpful as it allows a `TempDirectory` instance to be passed to directly to method that takes a `string` or a `DirectoryInfo`.


#### String Implicit Conversion

`TempDirectory` can be implicitly converter to a `string`:

<!-- snippet: TempDirectoryStringConversion -->
<a id='snippet-TempDirectoryStringConversion'></a>
```cs
[Fact]
public void StringConversion()
{
    using var temp = new TempDirectory();

    File.WriteAllText(Path.Combine(temp, "test.txt"), "content");

    // implicit conversion to string
    string path = temp;
    var files = Directory.EnumerateFiles(path);
    Trace.WriteLine(files.Count());
}
```
<sup><a href='/src/Verify.Tests/TempDirectoryTests.cs#L46-L61' title='Snippet source file'>snippet source</a> | <a href='#snippet-TempDirectoryStringConversion' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


#### DirectoryInfo Implicit Conversion

`TempDirectory` can be implicitly converter to a `DirectoryInfo`:

<!-- snippet: TempDirectoryDirectoryInfoConversion -->
<a id='snippet-TempDirectoryDirectoryInfoConversion'></a>
```cs
[Fact]
public void DirectoryInfoConversion()
{
    using var temp = new TempDirectory();

    File.WriteAllText(Path.Combine(temp, "test.txt"), "content");

    // implicit conversion to DirectoryInfo
    DirectoryInfo info = temp;
    var files = info.EnumerateFiles();
    Trace.WriteLine(files.Count());
}
```
<sup><a href='/src/Verify.Tests/TempDirectoryTests.cs#L63-L78' title='Snippet source file'>snippet source</a> | <a href='#snippet-TempDirectoryDirectoryInfoConversion' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Info Property

`TempDirectory` has a convenience `Info` that can be used to access all the `DirectoryInfo` members:

<!-- snippet: TempDirectoryInfoProperty -->
<a id='snippet-TempDirectoryInfoProperty'></a>
```cs
[Fact]
public void InfoProperty()
{
    using var temp = new TempDirectory();

    File.WriteAllText(Path.Combine(temp, "test.txt"), "content");

    var files = temp.Info.EnumerateFiles();
    Trace.WriteLine(files.Count());

    temp.Info.CreateSubdirectory("Subdirectory");
}
```
<sup><a href='/src/Verify.Tests/TempDirectoryTests.cs#L80-L95' title='Snippet source file'>snippet source</a> | <a href='#snippet-TempDirectoryInfoProperty' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### TempDirectory RootDirectory Property

Allows access to the root directory for all TempDirectory instances:

<!-- snippet: TempDirectoryInfoProperty -->
<a id='snippet-TempDirectoryInfoProperty'></a>
```cs
[Fact]
public void InfoProperty()
{
    using var temp = new TempDirectory();

    File.WriteAllText(Path.Combine(temp, "test.txt"), "content");

    var files = temp.Info.EnumerateFiles();
    Trace.WriteLine(files.Count());

    temp.Info.CreateSubdirectory("Subdirectory");
}
```
<sup><a href='/src/Verify.Tests/TempDirectoryTests.cs#L80-L95' title='Snippet source file'>snippet source</a> | <a href='#snippet-TempDirectoryInfoProperty' title='Start of snippet'>anchor</a></sup>
<!-- endSnippet -->


### Cleanup Behavior

The dispose cleans up the current instance.

The static constructor automatically:

1. Ensures the root directory `%TEMP%\VerifyTempDirectory` exists
1. Deletes sub-directories not modified in the last 24 hours
1. Runs once per application domain


### Thread Safety

Each instance creates a unique directory using `Path.GetRandomFileName()`, making concurrent usage safe.
